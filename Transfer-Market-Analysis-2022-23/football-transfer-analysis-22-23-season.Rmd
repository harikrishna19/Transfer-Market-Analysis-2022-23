---
title: "English Premier league 2022-23 Season Recap"
description: |
 English Premier league 2022-23 Season Recap
author: Hari Krishna
preview: transfer.png
date: 2023-05-23
output:
  distill::distill_article:
    self_contained: false
---

![]()

![](football.jpg){width="1058"}

Building a successful football team requires smart transfer decisions and recruitment and scouting of players.Impact in the player transfer plays an important role for overall season progress and teams competing for the major trophies require best summer/winter transfer windows.

Every year August,all the football fans in England will be excited for the return of Premier league,From fascinating match ups,local derbies,title challenges,European spots all are up for grabs

Especially I consider EPL as one of the top leagues in the world.

**Importance of Transfers:**

As, we know Manchester City are the Champions of this season again,their fourth title in last five seasons which shows that how major key transfer decisions over the years have helped them to be the dominant force in Europe.We majorly discuss on the transfer spending across top 5 European Leagues,the transfer spending spree of Chelsea and the major signings of this season of EPL and \>20 signings of Nottingham Forest under Steve Cooper,Could Arsenal have won the league if they had enough bench strength and so on

# Chelsea FC Signings

After the takeover of the new ownership and sacking of Thomas Tuchel,the season has been a disaster for Chelsea FC,they really struggles to keep it up in the points table and finished 12th in the season aggregating only 44 points

From Tuchel to Lampard the club was in a total transition period

Let's look at Chelsea's spending with the likes of Enzo Fernandez

But they have signed a lot of players

```{r}
library(tidyverse)
library(ggthemes)
library(worldfootballR)
library(patchwork)
library(png)
library(magick)
library(gridExtra)
library(grid)
```

```{r warning=FALSE,}
data=read.csv('Transfers.csv')

#Formatting nos to currncy
val<- function(x) {
  dplyr::case_when(
    x < 1e3 ~ as.character(x),
    x < 1e6 ~ paste0(as.character(x/1e3), "K"),
    x < 1e9 ~ paste0(as.character(x/1e6), "M"),
    TRUE ~ "To be implemented..."
  )
}

# dat %>% View()

data <- data %>% mutate(
  Transfer_Fee=val(transfer_fee)
)



```

```{r echo=FALSE,fig.width=10,fig.height=20, fig.cap="Chelsea 2022/23 Transfers",warning=FALSE,message=FALSE}
library(dplyr)
library(data.table)
# Loading Transfer Data --------------------------------------------------

#Chelsea Signings 2022-23 season
chelsea=data %>% dplyr::filter(team_name == "Chelsea FC" & transfer_type=="Arrivals" & transfer_fee>0)
chelsea$Transfer_Fee<-sub("M", "",chelsea$Transfer_Fee)
chelsea$Transfer_Fee<-as.numeric(chelsea$Transfer_Fee)

ggplot(data = chelsea, aes(x = reorder(player_name, Transfer_Fee), y = Transfer_Fee)) +
  geom_col(fill = "blue") + # Add text labels to the bars
  coord_flip() +
  scale_x_discrete(expand = c(0, 0)) +
  scale_y_continuous(labels = function(x) paste0(x, "M")) +  # Add "M" to y-axis labels
  theme_wsj() +
  labs(title="Chelsea Transfers 22/23",caption ="By Hari Krishna")+xlab("")


```

# Title Race-Manchester City-Arsenal

```{r}
# Arsenal vs City Title Race ----------------------------------------------
library(worldfootballR)
results=fb_match_results(country = "ENG",season_end_year = 2023,gender = "M",tier = "1st")


#mancity and Arsenal Trand for all 38 weeks

ars_data<-results %>% filter(Home=="Arsenal"|Away=="Arsenal")
mci_data<-results %>% filter(Home=="Manchester City"|Away=="Manchester City")



# Creating a new variable using case_when() and mutate() function
ars_data<-ars_data %>%
  mutate(
    Match_Result = case_when(
      HomeGoals == AwayGoals ~ "Draw",
      HomeGoals > AwayGoals ~ paste0(Home,  "Win"),
      AwayGoals > HomeGoals ~ paste0(Away,  "Win")
    )
  )


mci_data<-mci_data %>%
  mutate(
    Match_Result = case_when(
      HomeGoals == AwayGoals ~ "Draw",
      HomeGoals > AwayGoals ~ paste0(Home,  "Win"),
      AwayGoals > HomeGoals ~ paste0(Away,  "Win")
    )
  )


ars_data<-ars_data %>%
  mutate(
    Points = case_when(
      Match_Result=="ArsenalWin"~ 3,
      Match_Result=="Draw"~ 1,
      TRUE~0
      
    )
  )



mci_data<-mci_data %>%
  mutate(
    Points = case_when(
      Match_Result=="Manchester CityWin"~ 3,
      Match_Result=="Draw"~ 1,
      TRUE~0
    )
  )

ars_data$Wk<-as.numeric(ars_data$Wk)
mci_data$Wk<-as.numeric(mci_data$Wk)


```

```{r fig.width=10,fig.height=5}




gg_arsenal <- ggplot(ars_data, aes(x = Wk, y = Points, color = "Arsenal")) +
  geom_line() +
  geom_point() +
  scale_x_continuous(limits = c(1, 38), breaks = seq(1, 38, by = 1))+
  scale_y_continuous(breaks = c(0, 1, 3)) +
  labs(x = "MatchWeek", y = "Wk", color = "Team") +
  scale_color_manual(values = c("Arsenal" = "red"))+theme_wsj()



gg_city <- ggplot(mci_data, aes(x = Wk, y = Points, color = "Man City")) +
  geom_line() +
  geom_point() +
  scale_x_continuous(limits = c(1, 38), breaks = seq(1, 38, by = 1))+
  scale_y_continuous(breaks = c(0, 1, 3)) +
  labs(x = "MatchWeek", y = "Wk", color = "Team") +
  scale_color_manual(values = c("Man City" = "blue"))+theme_wsj()


# Combine the plots using the patchwork package
combined_plot <- gg_arsenal / gg_city

combined_plot



```
